# 机器人配置文件生成系统

## 项目概述

本项目根据Excel配置表和JSON模板，自动生成机器人单板的配置文件。系统能够解析复杂的Excel表格结构，提取接口信息，并按照指定的格式生成相应的JSON配置文件。

## 功能特点

1. **Excel解析**：能够解析复杂的Excel表格结构，识别单板型号和接口信息
2. **数据转换**：将Excel中的接口信息转换为标准的JSON格式
3. **规则匹配**：根据信号名称和接入类型自动识别接口类型（DI/DO/CAN等）
4. **自动命名**：根据单板型号自动生成配置文件名

## 处理流程

1. **读取Excel文件**：解析"整机配置表"工作表
2. **识别单板**：根据A列序号和C列单板型号识别不同单板
3. **提取接口**：从E、J、P等列提取接口信息
4. **转换格式**：将接口信息转换为标准JSON格式
5. **生成文件**：为每个单板生成对应的JSON配置文件

## 转换规则

### PIN信息提取规则
- Excel中的PIN格式如"PB14"会被转换为group="GPB", pin="14"
- 带括号的格式如"CSI0_DAT19(L6)"会提取括号内的内容

### 接口类型识别规则
- 包含"IN"、"input"的信号识别为DI类型
- 包含"OUT"、"output"的信号识别为DO类型
- 包含"CAN"的信号识别为CAN通信接口
- 根据P列接入类型判断CAN协议类型（UCAN/CANOPEN）

## 输出文件

系统为每个识别到的单板生成一个JSON配置文件，文件名为单板型号.json。

## 使用说明

1. 确保Excel文件和JSON模板文件在正确位置
2. 运行`python final_processor.py`生成配置文件
3. 配置文件将保存在output目录中

## 技术实现

- 使用openpyxl解析Excel文件
- 使用json模块处理JSON数据
- 采用面向对象的设计模式
- 支持错误处理和异常情况

## 项目结构

```
robot_programming_software/
├── final_processor.py      # 主处理程序
├── parse_excel.py          # Excel解析脚本
├── view_output.py          # 输出查看脚本
├── output/                 # 输出目录
│   └── *.json              # 生成的配置文件
└── README.md               # 本说明文件
```

## 注意事项

- Excel文件中的合并单元格需要特殊处理
- 配置文件中的接口信息基于Excel中的实际数据
- 生成的JSON文件遵循指定的格式规范
